knitr::opts_chunk$set(echo = TRUE)
ou <- function(alpha, sigma, b, r0, t.max, delta) {
n <- t.max/delta
r <- rep(r0, (n + 1))
for(i in 1:n) {
r[i+1] <- exp(-alpha * delta) * r[i] + b * (1 - exp(-alpha * delta)) +
sigma * sqrt((1 - exp(-2 * alpha * delta)) / (2 * alpha))  * rnorm(1)
}
return(r)
}
a <- c(0.1, 1, 5)
s <- c(0.1, 0.2, 0.5)
b <- c(-5, 5)
r <- matrix(NA, 18, 500^2+1)
for (i in 1:2) {
for (j in 1:3) {
for (k in 1:3) {
r[9 * (i - 1) + 3 * (j - 1) + k, ] <-
ou(a[j], s[k], b[i], 1, 500, 1/500)
}
}
}
r.new <- r[, -1]
View(r)
dim(r)
plot(ts(r.new[1, ], frequency=500),type='l',
ylim = c(-9, 2), ylab='', main='b = - 5, alpha = 0.1', col=2)
plot(r.new[1, ],type='l',
ylim = c(-9, 2), ylab='', main='b = - 5, alpha = 0.1', col=2)
plot(r.new[1, ],type='l',
ylim = c(-9, 2), ylab='', col=2)
lines(r.new[2, ], type='l', col=3)
lines(r.new[3, ], type='l', col=5)
plot(r.new[1, ],type='l',
ylim = c(-9, 2), ylab='', col=2)
lines(r.new[2, ], type='l', col=3)
lines(r.new[3, ], type='l', col=4)
lines(r.new[4, ], type='l', col=5)
lines(r.new[5, ], type='l', col=6)
lines(r.new[6, ], type='l', col=7)
legend("topright", legend=c('0.1, 0.1', '0.1, 0.2', '0.1, 0.5','1, 0.1', '1, 0.2', '1, 0.5'),
lty=c(1,1), col=c(2, 3, 4,5,6,7), title="(alpha , sigma)")
plot(r.new[1, ],type='l',ylim = c(-9, 2), ylab='', col=2,main='b =  5')
lines(r.new[2, ], type='l', col=3)
lines(r.new[3, ], type='l', col=4)
lines(r.new[4, ], type='l', col=5)
lines(r.new[5, ], type='l', col=6)
lines(r.new[6, ], type='l', col=7)
lines(r.new[7, ], type='l', col=8)
lines(r.new[8, ], type='l', col=9)
lines(r.new[9, ], type='l', col=10)
legend("topright", legend=c('0.1, 0.1', '0.1, 0.2', '0.1, 0.5','1, 0.1', '1, 0.2', '1, 0.5','5, 0.1', '5, 0.2', '5, 0.5'),
lty=c(1,1), col=c(2, 3, 4,5,6,7,8,9,10), title="(alpha , sigma)")
?legend
plot(r.new[1, ],type='l',ylim = c(-9, 2), ylab='', col=2,main='b =  5')
lines(r.new[2, ], type='l', col=3)
lines(r.new[3, ], type='l', col=4)
lines(r.new[4, ], type='l', col=5)
lines(r.new[5, ], type='l', col=6)
lines(r.new[6, ], type='l', col=7)
lines(r.new[7, ], type='l', col=8)
lines(r.new[8, ], type='l', col=9)
lines(r.new[9, ], type='l', col=10)
legend("right", legend=c('0.1, 0.1', '0.1, 0.2', '0.1, 0.5','1, 0.1', '1, 0.2', '1, 0.5','5, 0.1', '5, 0.2', '5, 0.5'),
lty=c(1,1), col=c(2, 3, 4,5,6,7,8,9,10), title="(alpha , sigma)")
plot(r.new[1, ],type='l',ylim = c(-9, 2), ylab='', col=2,main='b =  5',ylim=c(0,300000))
?plot
plot(r.new[1, ],type='l',ylim = c(-9, 2), ylab='', col=2,main='b =  5',xlim=c(0,300000))
lines(r.new[2, ], type='l', col=3)
lines(r.new[3, ], type='l', col=4)
lines(r.new[4, ], type='l', col=5)
lines(r.new[5, ], type='l', col=6)
lines(r.new[6, ], type='l', col=7)
lines(r.new[7, ], type='l', col=8)
lines(r.new[8, ], type='l', col=9)
lines(r.new[9, ], type='l', col=10)
legend("right", legend=c('0.1, 0.1', '0.1, 0.2', '0.1, 0.5','1, 0.1', '1, 0.2', '1, 0.5','5, 0.1', '5, 0.2', '5, 0.5'),
lty=c(1,1), col=c(2, 3, 4,5,6,7,8,9,10), title="(alpha , sigma)")
knitr::opts_chunk$set(echo = TRUE)
euler <- function(alpha, sigma, b, r0, delta) {
n <- 1/delta
r <- matrix(r0, 1000, n + 1)
for (i in 1:1000) {
for (j in 1:n) {
r[i, j+1] <- r[i, j] + alpha * (b - r[i, j]) * delta +
sigma * delta  * rnorm(1)
}
}
return(r)
}
a <- 0.1
s <- 0.1
b <- 5
init <- 8
delta <- c(1, 0.5, 0.1, 0.01)
mu <- exp(-a * delta[1]) * init + b * (1 - exp(-a * delta[1]))
sig <- s * sqrt((1 - exp(-2 * a * delta[1])) / (2 * a))
true <- function (x) {
exp(-((x-mu)^2) /(2*sig^2)) / sqrt(2*pi*sig^2)
}
sim1 <- euler(a, s, b, init, delta[1])[, 2]
sim2 <- euler(a, s, b, init, delta[2])[, 3]
sim3 <- euler(a, s, b, init, delta[3])[, 11]
sim4 <- euler(a, s, b, init, delta[4])[, 101]
hist(sim1, freq = F, ylim = c(0, 6), xlab = '', main = 'delta = 1')
lines(density(sim1), col = 3, lwd = 1)
curve(true, add = T, col = 4)
legend('topright', legend = c("simulated","true"),
lty = c(1, 1), lwd = c(1, 1), col = 3:4)
hist(sim2, freq = F, ylim = c(0, 8), xlab = '', main = 'delta = 0.5')
lines(density(sim2), col = 3, lwd = 1)
curve(true, add = T, col = 4)
legend('topright', legend = c("simulated","true"),
lty = c(1, 1), lwd = c(1, 1), col = 3:4)
hist(sim3, freq = F, ylim = c(0, 15), xlab = '', main = 'delta = 0.1')
lines(density(sim3), col = 3, lwd = 1)
curve(true, add = T, col = 4)
legend('topright', legend = c("simulated","true"),
lty = c(1, 1), lwd = c(1, 1), col = 3:4)
hist(sim4, freq = F, ylim = c(0, 60), xlab = '', main = 'delta = 0.01')
lines(density(sim4), col = 3, lwd = 1)
curve(true, add = T, col = 4)
legend('topright', legend = c("simulated","true"),
lty = c(1, 1), lwd = c(1, 1), col = 3:4)
euler <- function(alpha, sigma, b, r0, delta) {
n <- 1/delta
r <- matrix(r0, 1000, n + 1)
for (i in 1:1000) {
for (j in 1:n) {
r[i,j+1]<-r[i,j]+alpha*(b-r[i,j])*delta+sigma*delta*rnorm(1)
}
}
return(r)
}
a <- 0.1
s <- 0.1
b <- 5
init <- 8
delta <- c(1, 0.5, 0.1, 0.01)
mu <- exp(-a * delta[1]) * init + b * (1 - exp(-a * delta[1]))
sig <- s * sqrt((1 - exp(-2 * a * delta[1])) / (2 * a))
true <- function (x) {
exp(-((x-mu)^2) /(2*sig^2)) / sqrt(2*pi*sig^2)
}
sim1 <- euler(a, s, b, init, delta[1])[, 2]
sim2 <- euler(a, s, b, init, delta[2])[, 3]
sim3 <- euler(a, s, b, init, delta[3])[, 11]
sim4 <- euler(a, s, b, init, delta[4])[, 101]
lines(density(sim1), col = 3, lwd = 1)
plot(density(sim1), col = 3, lwd = 1)
curve(true, add = T, col = 4)
plot(density(sim1), col = 3, lwd = 1,ylim=c(0,5))
curve(true, add = T, col = 4)
plot(density(delta_is_1), col = 3, lwd = 1,ylim=c(0,5))
euler <- function(alpha, sigma, b, r0, delta) {
n <- 1/delta
r <- matrix(r0, 1000, n + 1)
for (i in 1:1000) {
for (j in 1:n) {
r[i,j+1]<-r[i,j]+alpha*(b-r[i,j])*delta+sigma*delta*rnorm(1)
}
}
return(r)
}
a <- 0.1
s <- 0.1
b <- 5
init <- 8
delta <- c(1, 0.5, 0.1, 0.01)
mu <- exp(-a * delta[1]) * init + b * (1 - exp(-a * delta[1]))
sig <- s * sqrt((1 - exp(-2 * a * delta[1])) / (2 * a))
true <- function (x) {
exp(-((x-mu)^2) /(2*sig^2)) / sqrt(2*pi*sig^2)
}
delta_is_1 <- euler(a, s, b, init, delta[1])[, 2]
sim2 <- euler(a, s, b, init, delta[2])[, 3]
sim3 <- euler(a, s, b, init, delta[3])[, 11]
sim4 <- euler(a, s, b, init, delta[4])[, 101]
plot(density(delta_is_1), col = 3, lwd = 1,ylim=c(0,5))
curve(true, add = T, col = 4)
legend('pright', legend = c("simulated","true"),lty = c(1, 1), lwd = c(1, 1), col = 3:4)
plot(density(delta_is_1), col = 3, lwd = 1,ylim=c(0,5))
curve(true, add = T, col = 4)
legend('right', legend = c("simulated","true"),lty = c(1, 1), lwd = c(1, 1), col = 3:4)
plot(r.new[1, ],type='l', ylab='', col=2,main='b =  5',xlim=c(0,300000))
lines(r.new[2, ], type='l', col=3)
lines(r.new[3, ], type='l', col=4)
lines(r.new[4, ], type='l', col=5)
lines(r.new[5, ], type='l', col=6)
lines(r.new[6, ], type='l', col=7)
lines(r.new[7, ], type='l', col=8)
lines(r.new[8, ], type='l', col=9)
lines(r.new[9, ], type='l', col=10)
legend("right", legend=c('0.1, 0.1', '0.1, 0.2', '0.1, 0.5','1, 0.1', '1, 0.2', '1, 0.5','5, 0.1', '5, 0.2', '5, 0.5'),lty=c(1,1), col=c(2, 3, 4,5,6,7,8,9,10), title="(alpha , sigma)")
plot(r.new[10, ],type='l', ylab='', col=2,main='b =  -5',xlim=c(0,300000))
lines(r.new[11, ], type='l', col=3)
lines(r.new[12, ], type='l', col=4)
lines(r.new[13, ], type='l', col=5)
lines(r.new[14, ], type='l', col=6)
lines(r.new[15, ], type='l', col=7)
lines(r.new[16, ], type='l', col=8)
lines(r.new[17, ], type='l', col=9)
lines(r.new[18, ], type='l', col=10)
legend("right", legend=c('0.1, 0.1', '0.1, 0.2', '0.1, 0.5','1, 0.1', '1, 0.2', '1, 0.5','5, 0.1', '5, 0.2', '5, 0.5'),lty=c(1,1), col=c(2, 3, 4,5,6,7,8,9,10), title="(alpha , sigma)")
plot(r.new[10, ],type='l',ylim = c(0, 6), ylab='', col=2,main='b =  -5',xlim=c(0,300000))
lines(r.new[11, ], type='l', col=3)
lines(r.new[12, ], type='l', col=4)
lines(r.new[13, ], type='l', col=5)
lines(r.new[14, ], type='l', col=6)
lines(r.new[15, ], type='l', col=7)
lines(r.new[16, ], type='l', col=8)
lines(r.new[17, ], type='l', col=9)
lines(r.new[18, ], type='l', col=10)
legend("right", legend=c('0.1, 0.1', '0.1, 0.2', '0.1, 0.5','1, 0.1', '1, 0.2', '1, 0.5','5, 0.1', '5, 0.2', '5, 0.5'),lty=c(1,1), col=c(2, 3, 4,5,6,7,8,9,10), title="(alpha , sigma)")
plot(r.new[10, ],type='l',ylim = c(0, 8), ylab='', col=2,main='b =  -5',xlim=c(0,300000))
lines(r.new[11, ], type='l', col=3)
lines(r.new[12, ], type='l', col=4)
lines(r.new[13, ], type='l', col=5)
lines(r.new[14, ], type='l', col=6)
lines(r.new[15, ], type='l', col=7)
lines(r.new[16, ], type='l', col=8)
lines(r.new[17, ], type='l', col=9)
lines(r.new[18, ], type='l', col=10)
legend("right", legend=c('0.1, 0.1', '0.1, 0.2', '0.1, 0.5','1, 0.1', '1, 0.2', '1, 0.5','5, 0.1', '5, 0.2', '5, 0.5'),lty=c(1,1), col=c(2, 3, 4,5,6,7,8,9,10), title="(alpha , sigma)")
