"0","euler <- function(alpha, sigma, b, r0, delta) {   "
"0","  "
"0","  n <- 1/delta"
"0","  "
"0","  r <- matrix(r0, 1000, n + 1) "
"0","  "
"0","  for (i in 1:1000) {   "
"0","    "
"0","      for (j in 1:n) {  "
"0","        "
"0","        r[i, j+1] <- r[i, j] + alpha * (b - r[i, j]) * delta + "
"0","           sigma * delta  * rnorm(1)"
"0","  "
"0","      }"
"0","  }"
"0","  "
"0","  return(r)"
"0","}"
"0",""
"0","a <- 0.1"
"0","s <- 0.1"
"0","b <- 5"
"0","init <- 8"
"0",""
"0","delta <- c(1, 0.5, 0.1, 0.01)"
"0",""
"0","mu <- exp(-a * delta[1]) * init + b * (1 - exp(-a * delta[1]))"
"0",""
"0","sig <- s * sqrt((1 - exp(-2 * a * delta[1])) / (2 * a))"
"0",""
"0","true <- function (x) {"
"0","  exp(-((x-mu)^2) /(2*sig^2)) / sqrt(2*pi*sig^2)"
"0","}"
"0",""
"0","sim1 <- euler(a, s, b, init, delta[1])[, 2]"
"0","sim2 <- euler(a, s, b, init, delta[2])[, 3]"
"0","sim3 <- euler(a, s, b, init, delta[3])[, 11]"
"0","sim4 <- euler(a, s, b, init, delta[4])[, 101]"
"0",""
"0","hist(sim1, freq = F, ylim = c(0, 6), xlab = '', main = 'delta = 1')"
